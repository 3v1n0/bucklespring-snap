name: bucklespring
license: GPL-2.0
adopt-info: buckle
summary: Nostalgia bucklespring keyboard sound
description: |
  This project emulates the sound of my old faithful IBM Model-M space saver
  bucklespring keyboard while typing on my notebook, mainly for the purpose of
  annoying the hell out of my coworkers.

  Bucklespring runs as a background
  process and plays back the sound of each key pressed and released on your
  keyboard, just as if you were using an IBM Model-M. The sound of each key has
  carefully been sampled, and is played back while simulating the proper
  distance and direction for a realistic 3D sound palette of pure nostalgic
  bliss.

base: core18
grade: stable
confinement: strict

apps:
  buckle:
    command: buckle-snap.run
    plugs: [x11, pulseaudio]

parts:
  deps:
    plugin: nil
    stage-packages:
      - libalure1
      - libasound2
      - libdumb1
      - libflac8
      - libfluidsynth1
      - libmodplug1
      - libmpg123-0
      - libopenal1
      - libsndfile1
      - libsndio6.1
      - libvorbisfile3
      - libx11-6
      - libxau6
      - libxcb1
      - libxdmcp6
      - libxext6
      - libxtst6

  buckle:
    plugin: make
    source: https://github.com/zevv/bucklespring.git
    override-pull: |
      snapcraftctl pull
      snapcraftctl set-version "$(git describe --tags --exclude="*win32*")"
      patch -p1 < $SNAPCRAFT_PROJECT_DIR/patches/scan-x11-Play-mouse-clicks-both-on-press-and-release.patch
    build-packages:
      - pkg-config
      - libopenal-dev
      - libalure-dev
      - libxtst-dev
    artifacts: ['buckle', 'wav']

  launcher:
    plugin: dump
    source: .
    filesets:
      launcherset: [ buckle-snap.run ]
    stage: [ $launcherset ]
    prime: [ $launcherset ]
